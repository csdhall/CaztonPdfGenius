<!DOCTYPE html>  
<html>  
<head>  
    <meta charset="UTF-8" />  
    <title>Cazton PDF Genius</title>  
    <link rel="stylesheet" href="UI/style.css">  
</head>  
<body>  
    <h1>Cazton PDF Genius</h1>  
    <div class="chat-container">  
        <div class="messages" id="chatbox"></div>  
        <form onsubmit="return askQuestion();" class="input-container">  
            <input  
                type="text"  
                id="inputBox"  
                class="input"  
                placeholder="Ask a question..."  
            />  
            <button type="submit">Ask</button>  
        </form>  
        <div id="dropZone" class="drop-zone">  
            <p>Drag and drop a PDF file here or click to upload</p>  
            <input type="file" id="fileInput" accept="application/pdf" style="display: none;">  
        </div>  
    </div>  
    <script>  
        const chatbox = document.getElementById("chatbox");  
        const inputBox = document.getElementById("inputBox");  
        const dropZone = document.getElementById("dropZone");  
        const fileInput = document.getElementById("fileInput");  
  
        dropZone.addEventListener("click", () => fileInput.click());  
        dropZone.addEventListener("dragover", (e) => {  
            e.preventDefault();  
            dropZone.classList.add("drag-over");  
        });  
        dropZone.addEventListener("dragleave", () => dropZone.classList.remove("drag-over"));  
        dropZone.addEventListener("drop", (e) => {  
            e.preventDefault();  
            dropZone.classList.remove("drag-over");  
            const file = e.dataTransfer.files[0];  
            if (file && file.type === "application/pdf") {  
                uploadPDF(file);  
            }  
        });  
        fileInput.addEventListener("change", (e) => {  
            const file = e.target.files[0];  
            if (file && file.type === "application/pdf") {  
                uploadPDF(file);  
            }  
        });  
  
        function uploadPDF(file) {  
            const formData = new FormData();  
            formData.append("file", file);  
  
            fetch("http://127.0.0.1:5500/upload", {  
                method: "POST",  
                body: formData,  
            })  
                .then((response) => response.json())  
                .then((data) => {  
                    appendMessage("Cazton", data.response);  
                })  
                .catch((error) => {  
                    console.error("Error:", error);  
                });  
        }  
  
        function askQuestion() {  
            const question = inputBox.value;  
            console.log("You: " + question);  
  
            if (question) {  
                inputBox.value = "";  
                appendMessage("You", question);  
                fetch("http://127.0.0.1:5500/qa", {  
                    method: "POST",  
                    headers: {  
                        "Content-Type": "application/json",  
                    },  
                    body: JSON.stringify({  
                        key: question,  
                    }),  
                })  
                    .then((response) => response.json())  
                    .then((data) => {  
                        const answer = data.response;  
                        appendMessage("Cazton", answer);  
                    })  
                    .catch((error) => {  
                        console.error("Error:", error);  
                    });  
            }  
  
            return false;  
        }  
  
        function appendMessage(sender, message) {  
            const messageElement = document.createElement("p");  
            messageElement.innerText = `${sender}: ${message}`;  
            chatbox.appendChild(messageElement);  
            messageElement.scrollIntoView();  
        }  
    </script>  
</body>  
</html>  
